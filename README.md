#DZ_JSON
Utilities for the creation of JSON and GeoJSON from Oracle data types and structures.
For the most up-to-date documentation see the auto-build  [dz_json_deploy.pdf](https://github.com/pauldzy/DZ_JSON/blob/master/dz_json_deploy.pdf).

Note these packages were created in the Oracle 10g days to transform Oracle and Oracle Spatial objects into JSON with GeoJSON as CLOBs to then drive REST-like sevices via mod_plsql.  While the intention always was to include JSON to SDO geometry conversion functionality, the code **currently** does not provide this, e.g. this only converts SDO to GeoJSON and not the other way around.  Adding JSON conversion would ideally harness the new JSON handling in 12c and I just do not yet have any production servers on 12c.  

#### GeoJSON Geometry Conversion Examples:

2D Point
```sql
SELECT  
dz_json_main.sdo2geojson(
   p_input  => MDSYS.SDO_GEOMETRY(2001,NULL,SDO_POINT_TYPE(-79,37,NULL),NULL,NULL) 
)  
FROM  
dual;

>> {"type":"Point","coordinates":[-79,37]}
```

2D Polygon
```sql
SELECT
dz_json_main.sdo2geojson(
   p_input  => MDSYS.SDO_GEOMETRY(
       2003
      ,NULL
      ,NULL
      ,MDSYS.SDO_ELEM_INFO_ARRAY(1,1003,1)
      ,MDSYS.SDO_ORDINATE_ARRAY(5,1, 8,1, 8,6, 5,7, 5,1)
  ) 
)  
FROM  
dual;

>> {"type":"Polygon","coordinates":[[[5,1],[8,1],[8,6],[5,7],[5,1]]]]}
```

3D Point
```sql
SELECT  
dz_json_main.sdo2geojson(
   p_input  => MDSYS.SDO_GEOMETRY(3001,NULL,SDO_POINT_TYPE(-79,37,200),NULL,NULL) 
)  
FROM  
dual;

>> {"type":"Point","coordinates":[-79,37,200]}
```

#### GeoJSON Feature Conversion Example:

3D Point with properties and numeric precision pruning including SRS info

```sql
SELECT  
dz_json_feature(  
    p_geometry => MDSYS.SDO_GEOMETRY(
         3001
        ,8265
        ,SDO_POINT_TYPE(-65.12345678901234567890,41.12345678901234567890,88.12345678901234567890)
        ,NULL
        ,NULL
    )  
   ,p_properties => dz_json_properties_vry(  
        dz_json_properties(  
            p_name => 'FeatureID'  
           ,p_properties_number => 1234  
        )  
       ,dz_json_properties(  
            p_name => 'FriedChickenStyle'  
           ,p_properties_string => 'Southern'  
        )  
       ,dz_json_properties(  
            p_name => 'AverageCostOfLemonade'  
           ,p_properties_number => 4.32  
        )  
    )   
).toJSON(  
    p_2d_flag       => 'FALSE'  
   ,p_pretty_print  => 0  
   ,p_prune_number  => 8  
   ,p_add_crs       => 'TRUE'  
   ,p_add_bbox      => 'FALSE'  
)  
FROM dual;

>> {  
    "type": "Feature"  
   ,"crs": {  
       "type": "name"  
      ,"properties": {  
         "name": "urn:ogc:def:crs:OGC::CRS83"  
       }  
   }  
   ,"geometry": {  
       "type": "Point"  
      ,"coordinates": [-65.12345678,41.12345678,88.12345678]  
   }  
   ,"properties": {  
       "FeatureID": 1234  
      ,"FriedChickenStyle": "Southern"  
      ,"AverageCostOfLemonade": 4.32  
   }  
}
```

##Installation
Simply execute the deployment script into the schema of your choice.  Then execute the code using either the same or a different schema.  All procedures and functions are publically executable and utilize AUTHID CURRENT_USER for permissions handling.

##Collaboration
Forks and pulls are **most** welcome.  The deployment script and deployment documentation files in the repository root are generated by my [build system](https://github.com/pauldzy/Speculative_PLSQL_CI) which obviously you do not have.  You can just ignore those files and when I merge your pull my system will autogenerate updated files for GitHub.

##Oracle Licensing Disclaimer
Oracle places the burden of matching functionality usage with server licensing entirely upon the user.  In the realm of Oracle Spatial, some features are "[spatial](http://download.oracle.com/otndocs/products/spatial/pdf/12c/oraspatitalandgraph_12_fo.pdf)" (and thus a separate purchased "option" beyond enterprise) and some are "[locator](http://download.oracle.com/otndocs/products/spatial/pdf/12c/oraspatialfeatures_12c_fo_locator.pdf)" (bundled with standard and enterprise).  This differentiation is ever changing.  Thus the definition for 11g is not exactly the same as the definition for 12c.  If you are seeking to utilize my code **without** a full Spatial option license, I do provide a good faith estimate of the licensing required and when coding I am conscious of keeping repository functionality to the simplest licensing level when possible.  However - as all such things go - the final burden of determining if functionality in a given repository matches your server licensing is entirely placed upon the user.  You should **always** fully inspect the code and its usage of Oracle functionality in light of your licensing.  Any reliance you place on my estimation is therefore strictly at your own risk.

In my estimation functionality in the DZ_JSON repository should match Oracle Locator licensing for 10g, 11g and 12c.


